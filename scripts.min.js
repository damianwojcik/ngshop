!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports["angular-file-upload"]=t():e["angular-file-upload"]=t()}(this,function(){return function(e){function t(r){if(o[r])return o[r].exports;var n=o[r]={exports:{},id:r,loaded:!1};return e[r].call(n.exports,n,n.exports,t),n.loaded=!0,n.exports}var o={};return t.m=e,t.c=o,t.p="",t(0)}([function(e,t,o){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}var n=r(o(1)),i=r(o(2)),a=r(o(3)),s=r(o(4)),c=r(o(5)),u=r(o(6)),l=r(o(7)),p=r(o(8)),d=r(o(9)),f=r(o(10)),h=r(o(11)),m=r(o(12)),g=r(o(13));angular.module(n.default.name,[]).value("fileUploaderOptions",i.default).factory("FileUploader",a.default).factory("FileLikeObject",s.default).factory("FileItem",c.default).factory("FileDirective",u.default).factory("FileSelect",l.default).factory("FileDrop",d.default).factory("FileOver",f.default).factory("Pipeline",p.default).directive("nvFileSelect",h.default).directive("nvFileDrop",m.default).directive("nvFileOver",g.default).run(["FileUploader","FileLikeObject","FileItem","FileDirective","FileSelect","FileDrop","FileOver","Pipeline",function(e,t,o,r,n,i,a,s){e.FileLikeObject=t,e.FileItem=o,e.FileDirective=r,e.FileSelect=n,e.FileDrop=i,e.FileOver=a,e.Pipeline=s}])},function(e,t){e.exports={name:"angularFileUpload"}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={url:"/",alias:"file",headers:{},queue:[],progress:0,autoUpload:!1,removeAfterUpload:!1,method:"POST",filters:[],formData:[],queueLimit:Number.MAX_VALUE,withCredentials:!1,disableMultipart:!1}},function(e,t,o){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t,o,n,a,v,y,w){var _=n.File,A=n.FormData,C=function(){function n(t){r(this,n);var o=c(e);u(this,o,t,{isUploading:!1,_nextIndex:0,_directives:{select:[],drop:[],over:[]}}),this.filters.unshift({name:"queueLimit",fn:this._queueLimitFilter}),this.filters.unshift({name:"folder",fn:this._folderFilter})}return n.prototype.addToQueue=function(e,t,o){var r=this,n=this.isArrayLikeObject(e)?Array.prototype.slice.call(e):[e],a=this._getFilters(o),s=this.queue.length,c=[],u=function(){r.queue.length!==s&&(r._onAfterAddingAll(c),r.progress=r._getTotalProgress()),r._render(),r.autoUpload&&r.uploadAll()};!function e(){var o=n.shift();if(m(o))return u();var s=r.isFile(o)?o:new v(o),l=r._convertFiltersToPipes(a),p=new w(l),d=function(t){var o=t.pipe.originalFilter,n=i(t.args,2),a=n[0],s=n[1];r._onWhenAddingFileFailed(a,o,s),e()},f=function(t,o){var n=new y(r,t,o);c.push(n),r.queue.push(n),r._onAfterAddingFile(n),e()};p.onThrown=d,p.onSuccessful=f,p.exec(s,t)}()},n.prototype.removeFromQueue=function(e){var t=this.getIndexOfItem(e),o=this.queue[t];o.isUploading&&o.cancel(),this.queue.splice(t,1),o._destroy(),this.progress=this._getTotalProgress()},n.prototype.clearQueue=function(){for(;this.queue.length;)this.queue[0].remove();this.progress=0},n.prototype.uploadItem=function(e){var t=this.getIndexOfItem(e),o=this.queue[t],r=this.isHTML5?"_xhrTransport":"_iframeTransport";o._prepareToUploading(),this.isUploading||(this._onBeforeUploadItem(o),o.isCancel||(o.isUploading=!0,this.isUploading=!0,this[r](o),this._render()))},n.prototype.cancelItem=function(e){var t=this,o=this.getIndexOfItem(e),r=this.queue[o],n=this.isHTML5?"_xhr":"_form";r&&(r.isCancel=!0,r.isUploading?r[n].abort():function(){var e=[void 0,0,{}];a(function(){t._onCancelItem.apply(t,[r].concat(e)),t._onCompleteItem.apply(t,[r].concat(e))})}())},n.prototype.uploadAll=function(){var e=this.getNotUploadedItems().filter(function(e){return!e.isUploading});e.length&&(l(e,function(e){return e._prepareToUploading()}),e[0].upload())},n.prototype.cancelAll=function(){var e=this.getNotUploadedItems();l(e,function(e){return e.cancel()})},n.prototype.isFile=function(e){return this.constructor.isFile(e)},n.prototype.isFileLikeObject=function(e){return this.constructor.isFileLikeObject(e)},n.prototype.isArrayLikeObject=function(e){return this.constructor.isArrayLikeObject(e)},n.prototype.getIndexOfItem=function(e){return d(e)?e:this.queue.indexOf(e)},n.prototype.getNotUploadedItems=function(){return this.queue.filter(function(e){return!e.isUploaded})},n.prototype.getReadyItems=function(){return this.queue.filter(function(e){return e.isReady&&!e.isUploading}).sort(function(e,t){return e.index-t.index})},n.prototype.destroy=function(){var e=this;l(this._directives,function(t){l(e._directives[t],function(e){e.destroy()})})},n.prototype.onAfterAddingAll=function(e){},n.prototype.onAfterAddingFile=function(e){},n.prototype.onWhenAddingFileFailed=function(e,t,o){},n.prototype.onBeforeUploadItem=function(e){},n.prototype.onProgressItem=function(e,t){},n.prototype.onProgressAll=function(e){},n.prototype.onSuccessItem=function(e,t,o,r){},n.prototype.onErrorItem=function(e,t,o,r){},n.prototype.onCancelItem=function(e,t,o,r){},n.prototype.onCompleteItem=function(e,t,o,r){},n.prototype.onCompleteAll=function(){},n.prototype._getTotalProgress=function(e){if(this.removeAfterUpload)return e||0;var t=this.getNotUploadedItems().length,o=t?this.queue.length-t:this.queue.length,r=100/this.queue.length,n=(e||0)*r/100;return Math.round(o*r+n)},n.prototype._getFilters=function(e){if(!e)return this.filters;if(h(e))return e;var t=e.match(/[^\s,]+/g);return this.filters.filter(function(e){return-1!==t.indexOf(e.name)})},n.prototype._convertFiltersToPipes=function(e){var t=this;return e.map(function(e){var o=s(t,e.fn);return o.isAsync=3===e.fn.length,o.originalFilter=e,o})},n.prototype._render=function(){t.$$phase||t.$apply()},n.prototype._folderFilter=function(e){return!(!e.size&&!e.type)},n.prototype._queueLimitFilter=function(){return this.queue.length<this.queueLimit},n.prototype._isSuccessCode=function(e){return e>=200&&300>e||304===e},n.prototype._transformResponse=function(e,t){var r=this._headersGetter(t);return l(o.defaults.transformResponse,function(t){e=t(e,r)}),e},n.prototype._parseHeaders=function(e){var t,o,r,n={};return e?(l(e.split("\n"),function(e){r=e.indexOf(":"),t=e.slice(0,r).trim().toLowerCase(),o=e.slice(r+1).trim(),t&&(n[t]=n[t]?n[t]+", "+o:o)}),n):n},n.prototype._headersGetter=function(e){return function(t){return t?e[t.toLowerCase()]||null:e}},n.prototype._xhrTransport=function(e){var t,o=this,r=e._xhr=new XMLHttpRequest;if(e.disableMultipart?t=e._file:(t=new A,l(e.formData,function(e){l(e,function(e,o){t.append(o,e)})}),t.append(e.alias,e._file,e.file.name)),"number"!=typeof e._file.size)throw new TypeError("The file specified is no longer valid");r.upload.onprogress=function(t){var r=Math.round(t.lengthComputable?100*t.loaded/t.total:0);o._onProgressItem(e,r)},r.onload=function(){var t=o._parseHeaders(r.getAllResponseHeaders()),n=o._transformResponse(r.response,t),i=o._isSuccessCode(r.status)?"Success":"Error";o["_on"+i+"Item"](e,n,r.status,t),o._onCompleteItem(e,n,r.status,t)},r.onerror=function(){var t=o._parseHeaders(r.getAllResponseHeaders()),n=o._transformResponse(r.response,t);o._onErrorItem(e,n,r.status,t),o._onCompleteItem(e,n,r.status,t)},r.onabort=function(){var t=o._parseHeaders(r.getAllResponseHeaders()),n=o._transformResponse(r.response,t);o._onCancelItem(e,n,r.status,t),o._onCompleteItem(e,n,r.status,t)},r.open(e.method,e.url,!0),r.withCredentials=e.withCredentials,l(e.headers,function(e,t){r.setRequestHeader(t,e)}),r.send(t)},n.prototype._iframeTransport=function(e){var t=this,o=g('<form style="display: none;" />'),r=g('<iframe name="iframeTransport'+Date.now()+'">'),n=e._input;e._form&&e._form.replaceWith(n),e._form=o,n.prop("name",e.alias),l(e.formData,function(e){l(e,function(e,t){var r=g('<input type="hidden" name="'+t+'" />');r.val(e),o.append(r)})}),o.prop({action:e.url,method:"POST",target:r.prop("name"),enctype:"multipart/form-data",encoding:"multipart/form-data"}),r.bind("load",function(){var o="",n=200;try{o=r[0].contentDocument.body.innerHTML}catch(e){n=500}var i={response:o,status:n,dummy:!0},a={},s=t._transformResponse(i.response,a);t._onSuccessItem(e,s,i.status,a),t._onCompleteItem(e,s,i.status,a)}),o.abort=function(){var i,a={status:0,dummy:!0},s={};r.unbind("load").prop("src","javascript:false;"),o.replaceWith(n),t._onCancelItem(e,i,a.status,s),t._onCompleteItem(e,i,a.status,s)},n.after(o),o.append(n).append(r),o[0].submit()},n.prototype._onWhenAddingFileFailed=function(e,t,o){this.onWhenAddingFileFailed(e,t,o)},n.prototype._onAfterAddingFile=function(e){this.onAfterAddingFile(e)},n.prototype._onAfterAddingAll=function(e){this.onAfterAddingAll(e)},n.prototype._onBeforeUploadItem=function(e){e._onBeforeUpload(),this.onBeforeUploadItem(e)},n.prototype._onProgressItem=function(e,t){var o=this._getTotalProgress(t);this.progress=o,e._onProgress(t),this.onProgressItem(e,t),this.onProgressAll(o),this._render()},n.prototype._onSuccessItem=function(e,t,o,r){e._onSuccess(t,o,r),this.onSuccessItem(e,t,o,r)},n.prototype._onErrorItem=function(e,t,o,r){e._onError(t,o,r),this.onErrorItem(e,t,o,r)},n.prototype._onCancelItem=function(e,t,o,r){e._onCancel(t,o,r),this.onCancelItem(e,t,o,r)},n.prototype._onCompleteItem=function(e,t,o,r){e._onComplete(t,o,r),this.onCompleteItem(e,t,o,r);var n=this.getReadyItems()[0];return this.isUploading=!1,f(n)?void n.upload():(this.onCompleteAll(),this.progress=this._getTotalProgress(),void this._render())},n.isFile=function(e){return _&&e instanceof _},n.isFileLikeObject=function(e){return e instanceof v},n.isArrayLikeObject=function(e){return p(e)&&"length"in e},n.inherit=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.super_=t},n}();return C.prototype.isHTML5=!(!_||!A),C.isHTML5=C.prototype.isHTML5,C}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){var o=[],r=!0,n=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(o.push(a.value),!t||o.length!==t);r=!0);}catch(e){n=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(n)throw i}}return o}return function(t,o){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,o);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t.default=n;var a=(function(e){return e&&e.__esModule?e:{default:e}}(o(1)),angular),s=a.bind,c=a.copy,u=a.extend,l=a.forEach,p=a.isObject,d=a.isNumber,f=a.isDefined,h=a.isArray,m=a.isUndefined,g=a.element;n.$inject=["fileUploaderOptions","$rootScope","$http","$window","$timeout","FileLikeObject","FileItem","Pipeline"]},function(e,t,o){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(){return function(){function e(t){r(this,e);var o=s(t)?t.value:t;this["_createFrom"+(c(o)?"FakePath":"Object")](o)}return e.prototype._createFromFakePath=function(e){this.lastModifiedDate=null,this.size=null,this.type="like/"+e.slice(e.lastIndexOf(".")+1).toLowerCase(),this.name=e.slice(e.lastIndexOf("/")+e.lastIndexOf("\\")+2)},e.prototype._createFromObject=function(e){this.lastModifiedDate=a(e.lastModifiedDate),this.size=e.size,this.type=e.type,this.name=e.name},e}()}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n;var i=(function(e){return e&&e.__esModule?e:{default:e}}(o(1)),angular),a=i.copy,s=i.isElement,c=i.isString},function(e,t,o){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){return function(){function o(e,n,i){r(this,o);var l=u(n),p=l?c(n):null,d=l?null:n;s(this,{url:e.url,alias:e.alias,headers:a(e.headers),formData:a(e.formData),removeAfterUpload:e.removeAfterUpload,withCredentials:e.withCredentials,disableMultipart:e.disableMultipart,method:e.method},i,{uploader:e,file:new t(n),isReady:!1,isUploading:!1,isUploaded:!1,isSuccess:!1,isCancel:!1,isError:!1,progress:0,index:null,_file:d,_input:p}),p&&this._replaceNode(p)}return o.prototype.upload=function(){try{this.uploader.uploadItem(this)}catch(t){var e=t.name+":"+t.message;this.uploader._onCompleteItem(this,e,t.code,[]),this.uploader._onErrorItem(this,e,t.code,[])}},o.prototype.cancel=function(){this.uploader.cancelItem(this)},o.prototype.remove=function(){this.uploader.removeFromQueue(this)},o.prototype.onBeforeUpload=function(){},o.prototype.onProgress=function(e){},o.prototype.onSuccess=function(e,t,o){},o.prototype.onError=function(e,t,o){},o.prototype.onCancel=function(e,t,o){},o.prototype.onComplete=function(e,t,o){},o.prototype._onBeforeUpload=function(){this.isReady=!0,this.isUploading=!1,this.isUploaded=!1,this.isSuccess=!1,this.isCancel=!1,this.isError=!1,this.progress=0,this.onBeforeUpload()},o.prototype._onProgress=function(e){this.progress=e,this.onProgress(e)},o.prototype._onSuccess=function(e,t,o){this.isReady=!1,this.isUploading=!1,this.isUploaded=!0,this.isSuccess=!0,this.isCancel=!1,this.isError=!1,this.progress=100,this.index=null,this.onSuccess(e,t,o)},o.prototype._onError=function(e,t,o){this.isReady=!1,this.isUploading=!1,this.isUploaded=!0,this.isSuccess=!1,this.isCancel=!1,this.isError=!0,this.progress=0,this.index=null,this.onError(e,t,o)},o.prototype._onCancel=function(e,t,o){this.isReady=!1,this.isUploading=!1,this.isUploaded=!1,this.isSuccess=!1,this.isCancel=!0,this.isError=!1,this.progress=0,this.index=null,this.onCancel(e,t,o)},o.prototype._onComplete=function(e,t,o){this.onComplete(e,t,o),this.removeAfterUpload&&this.remove()},o.prototype._destroy=function(){this._input&&this._input.remove(),this._form&&this._form.remove(),delete this._form,delete this._input},o.prototype._prepareToUploading=function(){this.index=this.index||++this.uploader._nextIndex,this.isReady=!0},o.prototype._replaceNode=function(t){var o=e(t.clone())(t.scope());o.prop("value",null),t.css("display","none"),t.after(o)},o}()}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n;var i=(function(e){return e&&e.__esModule?e:{default:e}}(o(1)),angular),a=i.copy,s=i.extend,c=i.element,u=i.isElement;n.$inject=["$compile","FileLikeObject"]},function(e,t,o){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(){var e=function(){function e(t){r(this,e),i(this,t),this.uploader._directives[this.prop].push(this),this._saveLinks(),this.bind()}return e.prototype.bind=function(){for(var e in this.events){var t=this.events[e];this.element.bind(e,this[t])}},e.prototype.unbind=function(){for(var e in this.events)this.element.unbind(e,this.events[e])},e.prototype.destroy=function(){var e=this.uploader._directives[this.prop].indexOf(this);this.uploader._directives[this.prop].splice(e,1),this.unbind()},e.prototype._saveLinks=function(){for(var e in this.events){var t=this.events[e];this[t]=this[t].bind(this)}},e}();return e.prototype.events={},e}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n;var i=(function(e){return e&&e.__esModule?e:{default:e}}(o(1)),angular).extend},function(e,t,o){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e,t){return function(t){function o(e){r(this,o);var i=s(e,{events:{$destroy:"destroy",change:"onChange"},prop:"select"}),a=n(this,t.call(this,i));return a.uploader.isHTML5||a.element.removeAttr("multiple"),a.element.prop("value",null),a}return i(o,t),o.prototype.getOptions=function(){},o.prototype.getFilters=function(){},o.prototype.isEmptyAfterSelection=function(){return!!this.element.attr("multiple")},o.prototype.onChange=function(){var t=this.uploader.isHTML5?this.element[0].files:this.element[0],o=this.getOptions(),r=this.getFilters();this.uploader.isHTML5||this.destroy(),this.uploader.addToQueue(t,o,r),this.isEmptyAfterSelection()&&(this.element.prop("value",null),this.element.replaceWith(e(this.element.clone())(this.scope)))},o}(t)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=a;var s=(function(e){return e&&e.__esModule?e:{default:e}}(o(1)),angular).extend;a.$inject=["$compile","FileDirective"]},function(e,t){"use strict";function o(e){if(Array.isArray(e)){for(var t=0,o=Array(e.length);t<e.length;t++)o[t]=e[t];return o}return Array.from(e)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e){return function(){function t(){var e=arguments.length<=0||void 0===arguments[0]?[]:arguments[0];r(this,t),this.pipes=e}return t.prototype.next=function(t){var r=this.pipes.shift();if(s(r))this.onSuccessful.apply(this,o(t));else{var n=new Error("The filter has not passed");if(n.pipe=r,n.args=t,r.isAsync){var i=e.defer(),c=a(this,this.next,t),u=a(this,this.onThrown,n);i.promise.then(c,u),r.apply(void 0,o(t).concat([i]))}else Boolean(r.apply(void 0,o(t)))?this.next(t):this.onThrown(n)}},t.prototype.exec=function(){for(var e=arguments.length,t=Array(e),o=0;e>o;o++)t[o]=arguments[o];this.next(t)},t.prototype.onThrown=function(e){},t.prototype.onSuccessful=function(){},t}()}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n;var i=angular,a=i.bind,s=i.isUndefined;n.$inject=["$q"]},function(e,t,o){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e){return function(e){function t(o){r(this,t);var i=c(o,{events:{$destroy:"destroy",drop:"onDrop",dragover:"onDragOver",dragleave:"onDragLeave"},prop:"drop"});return n(this,e.call(this,i))}return i(t,e),t.prototype.getOptions=function(){},t.prototype.getFilters=function(){},t.prototype.onDrop=function(e){var t=this._getTransfer(e);if(t){var o=this.getOptions(),r=this.getFilters();this._preventAndStop(e),u(this.uploader._directives.over,this._removeOverClass,this),this.uploader.addToQueue(t.files,o,r)}},t.prototype.onDragOver=function(e){var t=this._getTransfer(e);this._haveFiles(t.types)&&(t.dropEffect="copy",this._preventAndStop(e),u(this.uploader._directives.over,this._addOverClass,this))},t.prototype.onDragLeave=function(e){e.currentTarget!==this.element[0]&&(this._preventAndStop(e),u(this.uploader._directives.over,this._removeOverClass,this))},t.prototype._getTransfer=function(e){return e.dataTransfer?e.dataTransfer:e.originalEvent.dataTransfer},t.prototype._preventAndStop=function(e){e.preventDefault(),e.stopPropagation()},t.prototype._haveFiles=function(e){return!!e&&(e.indexOf?-1!==e.indexOf("Files"):!!e.contains&&e.contains("Files"))},t.prototype._addOverClass=function(e){e.addOverClass()},t.prototype._removeOverClass=function(e){e.removeOverClass()},t}(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=a;var s=(function(e){return e&&e.__esModule?e:{default:e}}(o(1)),angular),c=s.extend,u=s.forEach;a.$inject=["FileDirective"]},function(e,t,o){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function a(e){return function(e){function t(o){r(this,t);var i=s(o,{events:{$destroy:"destroy"},prop:"over",overClass:"nv-file-over"});return n(this,e.call(this,i))}return i(t,e),t.prototype.addOverClass=function(){this.element.addClass(this.getOverClass())},t.prototype.removeOverClass=function(){this.element.removeClass(this.getOverClass())},t.prototype.getOverClass=function(){return this.overClass},t}(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=a;var s=(function(e){return e&&e.__esModule?e:{default:e}}(o(1)),angular).extend;a.$inject=["FileDirective"]},function(e,t,o){"use strict";function r(e,t,o){return{link:function(r,n,i){var a=r.$eval(i.uploader);if(!(a instanceof t))throw new TypeError('"Uploader" must be an instance of FileUploader');var s=new o({uploader:a,element:n,scope:r});s.getOptions=e(i.options).bind(s,r),s.getFilters=function(){return i.filters}}}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r,function(e){e&&e.__esModule}(o(1)),r.$inject=["$parse","FileUploader","FileSelect"]},function(e,t,o){"use strict";function r(e,t,o){return{link:function(r,n,i){var a=r.$eval(i.uploader);if(!(a instanceof t))throw new TypeError('"Uploader" must be an instance of FileUploader');if(a.isHTML5){var s=new o({uploader:a,element:n});s.getOptions=e(i.options).bind(s,r),s.getFilters=function(){return i.filters}}}}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r,function(e){e&&e.__esModule}(o(1)),r.$inject=["$parse","FileUploader","FileDrop"]},function(e,t,o){"use strict";function r(e,t){return{link:function(o,r,n){var i=o.$eval(n.uploader);if(!(i instanceof e))throw new TypeError('"Uploader" must be an instance of FileUploader');var a=new t({uploader:i,element:r});a.getOverClass=function(){return n.overClass||a.overClass}}}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r,function(e){e&&e.__esModule}(o(1)),r.$inject=["FileUploader","FileOver"]}])}),function(){angular.module("angular-jwt",["angular-jwt.options","angular-jwt.interceptor","angular-jwt.jwt","angular-jwt.authManager"]),angular.module("angular-jwt.authManager",[]).provider("authManager",function(){this.$get=["$rootScope","$injector","$location","jwtHelper","jwtInterceptor","jwtOptions",function(e,t,o,r,n,i){function a(e){return Array.isArray(e)?t.invoke(e,this,{options:null}):e()}function s(e){if(Array.isArray(e)||angular.isFunction(e))return t.invoke(e,h,{});throw new Error("unauthenticatedRedirector must be a function")}function c(){var e=a(h.tokenGetter);return e?!r.isTokenExpired(e):void 0}function u(){e.isAuthenticated=!0}function l(){e.isAuthenticated=!1}function p(){e.$on("$locationChangeStart",function(){var t=a(h.tokenGetter);t&&(r.isTokenExpired(t)?e.$broadcast("tokenHasExpired",t):u())})}function d(){e.$on("unauthenticated",function(){s(h.unauthenticatedRedirector),l()})}function f(e,t){if(!t)return!1;var o=t.$$route?t.$$route:t.data;if(o&&!0===o.requiresLogin){var n=a(h.tokenGetter);(!n||r.isTokenExpired(n))&&(e.preventDefault(),s(h.unauthenticatedRedirector))}}var h=i.getConfig();e.isAuthenticated=!1;var m=t.has("$state")?"$stateChangeStart":"$routeChangeStart";return e.$on(m,f),{authenticate:u,unauthenticate:l,getToken:function(){return a(h.tokenGetter)},redirect:function(){return s(h.unauthenticatedRedirector)},checkAuthOnRefresh:p,redirectWhenUnauthenticated:d,isAuthenticated:c}}]}),angular.module("angular-jwt.interceptor",[]).provider("jwtInterceptor",function(){this.urlParam,this.authHeader,this.authPrefix,this.whiteListedDomains,this.tokenGetter;var e=this;this.$get=["$q","$injector","$rootScope","urlUtils","jwtOptions",function(t,o,r,n,i){function a(e){if(!n.isSameOrigin(e)&&!s.whiteListedDomains.length)throw new Error("As of v0.1.0, requests to domains other than the application's origin must be white listed. Use jwtOptionsProvider.config({ whiteListedDomains: [<domain>] }); to whitelist.");for(var t=n.urlResolve(e).hostname.toLowerCase(),o=0;o<s.whiteListedDomains.length;o++){var r=s.whiteListedDomains[o],i=r instanceof RegExp?r:new RegExp(r,"i");if(t.match(i))return!0}return!!n.isSameOrigin(e)}var s=angular.extend({},i.getConfig(),e);return{request:function(e){if(e.skipAuthorization||!a(e.url))return e;if(s.urlParam){if(e.params=e.params||{},e.params[s.urlParam])return e}else if(e.headers=e.headers||{},e.headers[s.authHeader])return e;return t.when(o.invoke(s.tokenGetter,this,{options:e})).then(function(t){return t&&(s.urlParam?e.params[s.urlParam]=t:e.headers[s.authHeader]=s.authPrefix+t),e})},responseError:function(e){return 401===e.status&&r.$broadcast("unauthenticated",e),t.reject(e)}}}]}),angular.module("angular-jwt.jwt",[]).service("jwtHelper",["$window",function(e){this.urlBase64Decode=function(t){var o=t.replace(/-/g,"+").replace(/_/g,"/");switch(o.length%4){case 0:break;case 2:o+="==";break;case 3:o+="=";break;default:throw"Illegal base64url string!"}return e.decodeURIComponent(escape(e.atob(o)))},this.decodeToken=function(e){var t=e.split(".");if(3!==t.length)throw new Error("JWT must have 3 parts");var o=this.urlBase64Decode(t[1]);if(!o)throw new Error("Cannot decode the token");return angular.fromJson(o)},this.getTokenExpirationDate=function(e){var t=this.decodeToken(e);if(void 0===t.exp)return null;var o=new Date(0);return o.setUTCSeconds(t.exp),o},this.isTokenExpired=function(e,t){var o=this.getTokenExpirationDate(e);return t=t||0,null!==o&&!(o.valueOf()>(new Date).valueOf()+1e3*t)}}]),angular.module("angular-jwt.options",[]).provider("jwtOptions",function(){var e={};this.config=function(t){e=t},this.$get=function(){function t(){this.config=angular.extend({},o,e)}var o={urlParam:null,authHeader:"Authorization",authPrefix:"Bearer ",whiteListedDomains:[],tokenGetter:function(){return null},loginPath:"/",unauthenticatedRedirectPath:"/",unauthenticatedRedirector:["$location",function(e){e.path(this.unauthenticatedRedirectPath)}]};return t.prototype.getConfig=function(){return this.config},new t}}),angular.module("angular-jwt.interceptor").service("urlUtils",function(){function e(e){var t=e;return o.setAttribute("href",t),t=o.href,o.setAttribute("href",t),{href:o.href,protocol:o.protocol?o.protocol.replace(/:$/,""):"",host:o.host,search:o.search?o.search.replace(/^\?/,""):"",hash:o.hash?o.hash.replace(/^#/,""):"",hostname:o.hostname,port:o.port,pathname:"/"===o.pathname.charAt(0)?o.pathname:"/"+o.pathname}}function t(t){var o=angular.isString(t)?e(t):t;return o.protocol===r.protocol&&o.host===r.host}var o=document.createElement("a"),r=e(window.location.href);return{urlResolve:e,isSameOrigin:t}})}(),function(){angular.module("angular-storage",["angular-storage.store"]),angular.module("angular-storage.cookieStorage",[]).service("cookieStorage",["$cookies",function(e){this.set=function(t,o){return e.put(t,o)},this.get=function(t){return e.get(t)},this.remove=function(t){return e.remove(t)}}]),angular.module("angular-storage.internalStore",["angular-storage.localStorage","angular-storage.sessionStorage"]).factory("InternalStore",["$log","$injector",function(e,t){function o(e,o,r,n){this.namespace=e||null,(angular.isUndefined(n)||null==n)&&(n=!0),this.useCache=n,this.delimiter=r||".",this.inMemoryCache={},this.storage=t.get(o||"localStorage")}return o.prototype.getNamespacedKey=function(e){return this.namespace?[this.namespace,e].join(this.delimiter):e},o.prototype.set=function(e,t){this.useCache&&(this.inMemoryCache[e]=t),this.storage.set(this.getNamespacedKey(e),JSON.stringify(t))},o.prototype.get=function(t){var o=null;if(this.useCache&&t in this.inMemoryCache)return this.inMemoryCache[t];var r=this.storage.get(this.getNamespacedKey(t));try{o=void 0===r||"undefined"===r?void 0:JSON.parse(r),this.useCache&&(this.inMemoryCache[t]=o)}catch(o){e.error("Error parsing saved value",o),this.remove(t)}return o},o.prototype.remove=function(e){this.useCache&&(this.inMemoryCache[e]=null),this.storage.remove(this.getNamespacedKey(e))},o}]),angular.module("angular-storage.localStorage",["angular-storage.cookieStorage"]).service("localStorage",["$window","$injector",function(e,t){var o;try{e.localStorage.setItem("testKey","test"),e.localStorage.removeItem("testKey"),o=!0}catch(e){o=!1}if(o)this.set=function(t,o){return e.localStorage.setItem(t,o)},this.get=function(t){return e.localStorage.getItem(t)},this.remove=function(t){return e.localStorage.removeItem(t)},this.clear=function(){e.localStorage.clear()};else{var r=t.get("cookieStorage");this.set=r.set,this.get=r.get,this.remove=r.remove}}]),angular.module("angular-storage.sessionStorage",["angular-storage.cookieStorage"]).service("sessionStorage",["$window","$injector",function(e,t){var o;try{e.sessionStorage.setItem("testKey","test"),e.sessionStorage.removeItem("testKey"),o=!0}catch(e){o=!1}if(o)this.set=function(t,o){return e.sessionStorage.setItem(t,o)},this.get=function(t){return e.sessionStorage.getItem(t)},this.remove=function(t){return e.sessionStorage.removeItem(t)};else{var r=t.get("cookieStorage");this.set=r.set,this.get=r.get,this.remove=r.remove}}]),angular.module("angular-storage.store",["angular-storage.internalStore"]).provider("store",function(){var e="localStorage",t=!0;this.setStore=function(t){t&&angular.isString(t)&&(e=t)},this.setCaching=function(e){t=!!e},this.$get=["InternalStore",function(o){var r=new o(null,e,null,t);return r.getNamespacedStore=function(e,t,r,n){return new o(e,t,r,n)},r}]})}();var app=angular.module("app",["ngRoute","angular-storage","angular-jwt","controllersNavigation","controllersAdmin","controllersSite","myServices"]);app.config(["$routeProvider","$httpProvider",function(e,t){e.when("/admin/products",{controller:"products",templateUrl:"partials/admin/products.html"}),e.when("/admin/product/edit/:id",{controller:"productEdit",templateUrl:"partials/admin/product-edit.html"}),e.when("/admin/product/create",{controller:"productCreate",templateUrl:"partials/admin/product-create.html"}),e.when("/admin/categories",{controller:"categories",templateUrl:"partials/admin/categories.html"}),e.when("/admin/category/edit/:id",{controller:"categoryEdit",templateUrl:"partials/admin/category-edit.html"}),e.when("/admin/category/create",{controller:"categoryCreate",templateUrl:"partials/admin/category-create.html"}),e.when("/admin/users",{controller:"users",templateUrl:"partials/admin/users.html"}),e.when("/admin/user/edit/:id",{controller:"userEdit",templateUrl:"partials/admin/user-edit.html"}),e.when("/admin/user/create",{controller:"userCreate",templateUrl:"partials/admin/user-create.html"}),e.when("/admin/orders",{controller:"orders",templateUrl:"partials/admin/orders.html"}),e.when("/admin/:slug",{controller:"adminCategory",templateUrl:"partials/admin/category.html"}),e.when("/products",{controller:"siteProducts",templateUrl:"partials/site/products.html"}),e.when("/product/:id",{controller:"siteProduct",templateUrl:"partials/site/product.html"}),e.when("/cart",{controller:"cartCtrl",templateUrl:"partials/site/cart.html"}),e.when("/orders",{controller:"siteOrders",templateUrl:"partials/site/orders.html"}),e.when("/:slug",{controller:"siteCategory",templateUrl:"partials/site/category.html"}),e.when("/login",{controller:"login",templateUrl:"partials/site/login.html"}),e.when("/register",{controller:"register",templateUrl:"partials/site/register.html"}),e.otherwise({redirectTo:"/products"})}]);var myDirectives=angular.module("myDirectives",[]);myDirectives.directive("ngThumb",["$window",function(e){var t={support:!(!e.FileReader||!e.CanvasRenderingContext2D),isFile:function(t){return angular.isObject(t)&&t instanceof e.File},isImage:function(e){var t="|"+e.type.slice(e.type.lastIndexOf("/")+1)+"|";return-1!=="|jpg|png|jpeg|bmp|gif|".indexOf(t)}};return{restrict:"A",template:"<canvas/>",link:function(e,o,r){function n(e){var t=new Image;t.onload=i,t.src=e.target.result}function i(){var e=a.width||this.width/this.height*a.height,t=a.height||this.height/this.width*a.width;s.attr({width:e,height:t}),s[0].getContext("2d").drawImage(this,0,0,e,t)}if(t.support){var a=e.$eval(r.ngThumb);if(t.isFile(a.file)&&t.isImage(a.file)){var s=o.find("canvas"),c=new FileReader;c.onload=n,c.readAsDataURL(a.file)}}}}}]),myDirectives.directive("onFinishRender",function(e){return{restrict:"A",link:function(t,o,r){!0===t.$last&&e(function(){t.$emit(r.onFinishRender)})}}});var myServices=angular.module("myServices",[]);myServices.factory("cartService",["store",function(e){if(e.get("cart"))t=e.get("cart");else var t=[];return t.show=function(){return t},t.add=function(o){var r=!0;angular.forEach(t,function(e,n){e.name==o.name&&(r=!1,t[n].amount++)}),r&&(o.amount=1,t.push(o)),e.set("cart",t)},t.empty=function(){e.remove("cart"),t.length=0},t.update=function(t){e.set("cart",t)},t}]),myServices.service("checkToken",["store","jwtHelper",function(e,t){if(e.get("token"))t.decodeToken(e.get("token"));else;this.payload=function(){return!!e.get("token")&&t.decodeToken(e.get("token"))},this.loggedIn=function(){return!!e.get("token")},this.isAdmin=function(){return!!e.get("token")&&"admin"==t.decodeToken(e.get("token")).role},this.raw=function(){return e.get("token")},this.del=function(){e.remove("token")}}]),myServices.service("productsService",["$http",function(e){this.getByCategoryId=function(t){return e.get("api/site/products/getByCategoryId/"+t).success(function(e){return e}).error(function(){console.log("Error on communicate with API.")})},this.getByCategorySlug=function(t){return e.get("api/site/products/getByCategorySlug/"+t).success(function(e){return e}).error(function(){console.log("Error on communicate with API.")})}}]),myServices.service("categoriesService",["$http",function(e){this.getData=function(){return e.get("api/site/categories/get").success(function(e){return e}).error(function(){console.log("Error on communicate with API.")})},this.getByCategorySlug=function(t){return e.get("api/site/categories/getByCategorySlug/"+t).success(function(e){return e}).error(function(){console.log("Error on communicate with API.")})}}]);var controllersAdmin=angular.module("controllersAdmin",["angularFileUpload","myDirectives","ui.select","ngSanitize"]);controllersAdmin.controller("products",["$scope","$http","checkToken","categoriesService",function(e,t,o,r){t.post("api/admin/products/get",{token:o.raw()}).success(function(t){e.products=t}).error(function(){console.log("Error on communicate with API.")}),r.getData().then(function(t){e.categories=t.data}),e.delete=function(r,n){if(!confirm("Are you really want to delete this product?"))return!1;e.products.splice(n,1),t.post("api/admin/products/delete/",{token:o.raw(),product:r}).error(function(){console.log("Error on communicate with API.")})}}]),controllersAdmin.controller("productEdit",["$scope","$http","$routeParams","FileUploader","$timeout","checkToken","categoriesService",function(e,t,o,r,n,i,a){function s(){t.post("api/admin/images/get/"+c,{token:i.raw()}).success(function(t){e.images=t}).error(function(){console.log("Error on communicate with API.")})}var c=o.id;e.id=c,t.post("api/admin/products/get/"+c,{token:i.raw()}).success(function(t){e.product=t,a.getData().then(function(t){e.categories=t.data,e.product.category=e.categories[e.product.category-1]})}).error(function(){console.log("Error on communicate with API.")}),s();var u=e.uploader=new r({token:i.raw(),url:"api/admin/images/upload/"+c});u.filters.push({name:"imageFilter",fn:function(e,t){var o="|"+e.type.slice(e.type.lastIndexOf("/")+1)+"|";return-1!=="|jpg|png|jpeg|bmp|gif|".indexOf(o)}}),u.onCompleteItem=function(t,o,r,n){s(),e.product.thumbnail="uploads/"+c+"/"+t._file.name},e.delImage=function(o,r){e.images.splice(r,1),t.post("api/admin/images/delete/",{token:i.raw(),id:c,image:o}).error(function(){console.log("Error on communicate with API.")})},e.setThumbnail=function(t,o){e.product.thumbnail==o?e.product.thumbnail="":e.product.thumbnail=o},e.saveChanges=function(o){o&&(o.category=o.category.id),t.post("api/admin/products/update/",{token:i.raw(),product:o}).success(function(){e.success=!0,a.getData().then(function(t){e.categories=t.data,e.product.category=e.categories[e.product.category-1]}),n(function(){e.success=!1},3e3)}).error(function(){console.log("Error on communicate with API.")}),t.post("api/admin/images/setThumbnail/",{token:i.raw(),product:o,image:o.thumbnail}).error(function(){console.log("Error on communicate with API.")})}}]),controllersAdmin.controller("productCreate",["$scope","$http","$timeout","checkToken","categoriesService",function(e,t,o,r,n){e.product={},n.getData().then(function(t){e.categories=t.data,e.product.category=t.data[0]}),e.createProduct=function(i){i&&(i.category=i.category.id),t.post("api/admin/products/create/",{token:r.raw(),product:i}).success(function(){e.success=!0,e.product={},o(function(){e.success=!1,n.getData().then(function(t){e.categories=t.data,e.product.category=t.data[0]})},3e3)}).error(function(){console.log("Error on communicate with API.")})}}]),controllersAdmin.controller("categories",["$scope","$http","categoriesService","productsService","checkToken",function(e,t,o,r,n){o.getData().then(function(t){e.categories=t.data}),e.products=[],e.productsCount=[],e.getProducts=function(t){r.getByCategoryId(t).then(function(o){e.products[t]=o.data,e.productsCount[t]=e.products[t].length})},e.delete=function(o,r){if(!confirm("Are you really want to delete this category?"))return!1;e.categories.splice(r,1),t.post("api/admin/categories/delete/",{token:n.raw(),category:o}).error(function(){console.log("Error on communicate with API.")})}}]),controllersAdmin.controller("categoryCreate",["$scope","$http","$timeout","checkToken","categoriesService","productsService",function(e,t,o,r,n,i){e.category={},n.getData().then(function(t){e.categories=t.data,e.category.id=e.categories.length+1}),i.getByCategoryId(1).then(function(t){e.products=t.data}),e.createCategory=function(a,s){angular.forEach(s.selected,function(o){o.category=a.id,t.post("api/admin/products/update/",{token:r.raw(),product:o}).success(function(){e.success=!0}).error(function(){console.log("Error on communicate with API.")})}),t.post("api/admin/categories/create/",{token:r.raw(),category:a}).success(function(){e.success=!0,e.category={},n.getData().then(function(t){e.categories=t.data,e.category.id=e.categories.length+1}),i.getByCategoryId(1).then(function(t){e.products=t.data}),o(function(){e.success=!1},3e3)}).error(function(){console.log("Error on communicate with API.")})}}]),controllersAdmin.controller("categoryEdit",["$scope","$http","$q","$timeout","$routeParams","checkToken",function(e,t,o,r,n,i){Array.prototype.diff=function(e){return this.filter(function(t){return e.indexOf(t)<0})};var a=n.id;e.id=a,t.post("api/admin/categories/get/"+a,{token:i.raw()}).success(function(t){e.category=t}).error(function(){console.log("Error on communicate with API.")}),e.productsUncategorized=t.get("api/site/products/getByCategoryId/1",{cache:!1}),e.productsFromCategory=t.get("api/site/products/getByCategoryId/"+a,{cache:!1}),o.all([e.productsUncategorized,e.productsFromCategory]).then(function(t){e.products=t[0].data.concat(t[1].data)}),t.get("api/site/products/getByCategoryId/"+a).success(function(t){e.products.selected=t}).error(function(){console.log("Error on communicate with API.")}),e.saveChanges=function(o,n){var a=n.filter(function(e){return e.id!==n.length}),s=[];s=a.length===n.selected.length?[]:a.diff(n.selected),t.post("api/admin/categories/update/",{token:i.raw(),category:o}).success(function(){e.success=!0,r(function(){e.success=!1},3e3)}).error(function(){console.log("Error on communicate with API.")}),angular.forEach(n.selected,function(r){r.category=o.id,t.post("api/admin/products/update/",{token:i.raw(),product:r}).success(function(){e.success=!0}).error(function(){console.log("Error on communicate with API.")})}),s.length&&angular.forEach(s,function(o){o.category=1,t.post("api/admin/products/update/",{token:i.raw(),product:o}).success(function(){e.success=!0}).error(function(){console.log("Error on communicate with API.")})})}}]),controllersAdmin.controller("users",["$scope","$http","checkToken",function(e,t,o){t.post("api/admin/users/get",{token:o.raw()}).success(function(t){e.users=t}).error(function(){console.log("Error on communicate with API.")}),e.delete=function(o,r){if(!confirm("Are you really want to delete this user?"))return!1;e.users.splice(r,1),t.post("api/admin/users/delete/",{user:o}).error(function(){console.log("Error on communicate with API.")})}}]),controllersAdmin.controller("userEdit",["$scope","$http","$routeParams","$timeout","checkToken",function(e,t,o,r,n){var i=o.id;e.id=i,t.post("api/admin/users/get/"+i,{token:n.raw()}).success(function(t){e.user=t}).error(function(){console.log("Error on communicate with API.")}),e.saveChanges=function(o){t.post("api/admin/users/update/",{token:n.raw(),id:i,user:o,firstName:o.firstName,lastName:o.lastName,email:o.email,password:o.password,passconf:o.passconf}).success(function(t){e.submit=!0,t?e.errors=t:(e.success=!0,r(function(){e.success=!1},3e3)),e.submit=!0}).error(function(){console.log("Error on communicate with API.")})}}]),controllersAdmin.controller("userCreate",["$scope","$http","$timeout","checkToken",function(e,t,o,r){e.user={},e.user.role="user",e.createUser=function(n){t.post("api/admin/users/create/",{token:r.raw(),user:n,firstName:n.firstName,lastName:n.lastName,email:n.email,password:n.password,passconf:n.passconf}).success(function(t){t?e.errors=t:(e.user={},e.success=!0,o(function(){e.success=!1},3e3)),e.submit=!0}).error(function(){console.log("Error on communicate with API.")})}}]),controllersAdmin.controller("orders",["$scope","$http","checkToken",function(e,t,o){t.post("api/admin/orders/get/",{token:o.raw(),payload:o.payload()}).success(function(t){e.orders=t,angular.forEach(e.orders,function(t,o){var r=JSON.parse(t.items);e.orders[o].items=r})}).error(function(){console.log("Error on communicate with API.")}),e.delete=function(r,n){if(!confirm("Are you really want to delete this order?"))return!1;e.orders.splice(n,1),t.post("api/admin/orders/delete/",{token:o.raw(),id:r.id}).error(function(){console.log("Error on communicate with API.")})},e.changeStatus=function(e){0==e.status?e.status=1:e.status=0,t.post("api/admin/orders/update/",{token:o.raw(),id:e.id,status:e.status}).error(function(){console.log("Error on communicate with API.")})}}]),controllersAdmin.controller("adminCategory",["$scope","$http","$location","$window","$routeParams","productsService","categoriesService","checkToken",function(e,t,o,r,n,i,a,s){var c=n.slug;i.getByCategorySlug(c).then(function(t){e.products=t.data}),a.getByCategorySlug(c).then(function(t){e.category=t.data}),e.deleteProduct=function(o,r){if(!confirm("Are you really want to delete this product?"))return!1;e.products.splice(r,1),t.post("api/admin/products/delete/",{token:s.raw(),product:o}).error(function(){console.log("Error on communicate with API.")})},e.deleteCategory=function(e){if(!confirm("Are you really want to delete this category?"))return!1;t.post("api/admin/categories/delete/",{token:s.raw(),category:e}).success(function(){o.path("/admin/categories")}).error(function(){console.log("Error on communicate with API.")})}}]);var controllersNavigation=angular.module("controllersNavigation",["myDirectives"]);controllersNavigation.controller("navigation",["$scope","$http","$location","checkToken","store","cartService","categoriesService",function(e,t,o,r,n,i,a){e.navigation=function(){return/^\/admin/.test(o.path())?(r.isAdmin()||(window.location.href="#/products?alert=notAdmin"),"partials/admin/navigation.html"):("notAdmin"==o.search().alert?e.notAdmin=!0:e.notAdmin=!1,r.loggedIn()?e.loggedIn=!0:e.loggedIn=!1,r.isAdmin()?e.isAdmin=!0:e.isAdmin=!1,"partials/site/navigation.html")},e.isActive=function(e){return o.path()===e},e.$watch(function(){e.cart=i.show()}),e.logout=function(){r.del(),o.path("/products")},e.removeItem=function(t){e.cart.splice(t,1),i.update(e.cart)},a.getData().then(function(t){e.categories=t.data}),e.$on("ngRepeatFinished",function(){var t=$(".nav-bottom .nav");$(".nav-bottom .nav li.active").length&&(t.append("<li id='magic-line'></li>"),e.magicLine=$("#magic-line"),e.magicLine.width($(".nav-bottom .nav li.active").width()).css("left",$(".nav-bottom .nav li.active").position().left).data("origLeft",e.magicLine.position().left).data("origWidth",e.magicLine.width()),$(".nav-bottom .nav li").hover(function(){e.el=$(this),e.leftPos=e.el.position().left,e.newWidth=e.el.width(),e.magicLine.stop().animate({left:e.leftPos,width:e.newWidth})},function(){e.magicLine.stop().animate({left:e.magicLine.data("origLeft"),width:e.magicLine.data("origWidth")})}),$(".nav-bottom .nav li").click(function(){e.el=$(this),e.leftPos=e.el.position().left,e.newWidth=e.el.width(),e.magicLine.data("origLeft",e.el.position().left).data("origWidth",e.el.width()),e.magicLine.stop().animate({left:e.leftPos,width:e.newWidth})}))})}]);var controllersSite=angular.module("controllersSite",[]);controllersSite.controller("siteProducts",["$scope","$http","cartService","categoriesService",function(e,t,o,r){t.get("api/site/products/get").success(function(t){e.products=t}).error(function(){console.log("Error on communicate with API.")}),r.getData().then(function(t){e.categories=t.data}),e.$watch(function(){e.cart=o.show()}),e.addToCart=function(e){o.add(e)},e.checkCart=function(e){o.show().length&&angular.forEach(o.show(),function(t){t.id==e.id&&(e.amount=t.amount)})}}]),controllersSite.controller("siteProduct",["$scope","$http","$routeParams","cartService",function(e,t,o,r){var n=o.id;t.post("api/site/products/get/"+n).success(function(t){e.product=t,e.checkCart(t)}).error(function(){console.log("Error on communicate with API.")}),e.addToCart=function(e){r.add(e)},e.checkCart=function(e){r.show().length&&angular.forEach(r.show(),function(t){t.id==e.id&&(e.amount=t.amount)})},function(){t.get("api/site/products/getImages/"+n).success(function(t){e.images=t}).error(function(){console.log("Error on communicate with API.")})}()}]),controllersSite.controller("siteOrders",["$scope","$http","checkToken",function(e,t,o){t.post("api/site/orders/get/",{token:o.raw(),payload:o.payload()}).success(function(t){e.orders=t,angular.forEach(e.orders,function(t,o){var r=JSON.parse(t.items);e.orders[o].items=r})}).error(function(){console.log("Error on communicate with API.")})}]),controllersSite.controller("cartCtrl",["$scope","$http","$filter","cartService","checkToken",function(e,t,o,r,n){e.cart=r.show(),e.emptyCart=function(){r.empty()},e.total=function(){var t=0;return angular.forEach(e.cart,function(e){t+=e.amount*e.price}),t=o("number")(t,2)},e.removeItem=function(t){e.cart.splice(t,1),r.update(e.cart)},e.setOrder=function(o){if(o.preventDefault(),!n.loggedIn())return e.alert={type:"warning",msg:"You have to be logged in."},!1;t.post("api/site/orders/create/",{token:n.raw(),payload:n.payload(),items:e.cart,total:e.total()}).success(function(t){r.empty(),e.alert={type:"success",msg:"Order in process. Dont refresh the page."},$("#paypalForm").submit()}).error(function(){console.log("Error on communicate with API.")})},e.$watch(function(){r.update(e.cart)})}]),controllersSite.controller("siteOrders",["$scope","$http","checkToken",function(e,t,o){t.post("api/site/orders/get/",{token:o.raw(),payload:o.payload()}).success(function(t){e.orders=t,angular.forEach(e.orders,function(t,o){var r=JSON.parse(t.items);e.orders[o].items=r})}).error(function(){console.log("Error on communicate with API.")})}]),controllersSite.controller("siteCategory",["$scope","$http","$routeParams","cartService","productsService","categoriesService",function(e,t,o,r,n,i){var a=o.slug;n.getByCategorySlug(a).then(function(t){e.products=t.data}),i.getData().then(function(t){e.categories=t.data}),e.addToCart=function(e){r.add(e)},e.checkCart=function(e){r.show().length&&angular.forEach(r.show(),function(t){t.id==e.id&&(e.amount=t.amount)})}}]),controllersSite.controller("login",["$scope","$http","store","checkToken","$location",function(e,t,o,r,n){r.loggedIn()&&n.path("/products"),e.user={},e.formSubmit=function(r){t.post("api/site/user/login/",{email:r.email,password:r.password}).success(function(t){e.submit=!0,e.error=t.error,t.error||(o.set("token",t.token),n.path("/products"))}).error(function(){console.log("Error on communicate with API.")})}}]),controllersSite.controller("register",["$scope","$http",function(e,t){e.user={},e.formSubmit=function(o){t.post("api/site/user/create/",{user:o,firstName:o.firstName,lastName:o.lastName,email:o.email,password:o.password,passconf:o.passconf}).success(function(t){e.submit=!0,e.user={},t?e.errors=t:(e.errors={},e.success=!0)}).error(function(){console.log("Error on communicate with API.")})}}]);